import{u as $,o as F,r as c,l as s,F as N,k as e,f as y,p as T,S as _,O as j}from"./index-zu87m18r.js";import{M as A}from"./ModuleHeader-12fJkJ5t.js";import{F as L,C as O,L as W}from"./confirmModal-C_kkW56o.js";import{v as P}from"./vlifeModal-CNFwsqlW.js";import{D as u}from"./index-D_2oZ5Sg.js";import{S as U}from"./index-CX0w8x5_.js";import{l as V}from"./SysApp-DRxQSclV.js";import{u as v}from"./GroupLabel-CFJ4I-sR.js";import{C as B}from"./CreateEntityBtn-BEVeCO4b.js";import{u as G}from"./index-BmfRL-y0.js";import{V as H}from"./VfUserGuide-BKR-0q3f.js";import"./index-D84rZFL3.js";import"./index-DA-42-7E.js";import"./formPage-D0LEgB12.js";import"./BtnToolBar-eoxdJY99.js";import"./VF-CFm92MRs.js";import"./isBrowser-DDdYk2YE.js";const J=()=>{var b;const{app:i}=$(),f=F(),[t,x]=G(),[r,w]=c.useState([]),{appModels:o}=v({sysAppId:t==null?void 0:t.appId});c.useEffect(()=>{V().then(l=>{w(l.data||[])})},[]);const{model:m}=v({id:t==null?void 0:t.modelId}),n=c.useMemo(()=>{if(m)return m.itemType==="entity"?m.id:m.entityId},[m]);c.useEffect(()=>{i!=null&&i.id&&!t.appId&&x({appId:i==null?void 0:i.id}),n&&n!==t.modelId&&x({modelId:n})},[i,n,t]);const d=c.useMemo(()=>o==null?void 0:o.filter(l=>l.sysAppId===(t==null?void 0:t.appId)&&l.itemType==="entity"),[o]),h=c.useCallback(({list:l,label:I,desc:M,icon:S,className:C})=>l&&l.length>0?s(N,{children:[s("div",{className:`${C} w-full h-9 flex justify-between px-4  items-center border-dashed  border-b border-blue-500 my-1`,children:[s("div",{className:" text-white  text-sm font-bold border-blue-500 space-x-1 ",children:[e("span",{children:S})," ",s("span",{children:[" ",I]})]}),e("div",{className:" text-white text-xs  ",children:M})]}),l==null?void 0:l.map((a,k)=>{var p;return e("div",{onClick:()=>{a.id!==n&&f(`/modelDesign/detail?appId=${t.appId}&modelId=${a.id}`)},className:`w-full pl-2 pr-4 h-8 cursor-pointer  text-gray-500 ${y({"bg-blue-100 !text-gray-500 border-orange-400 border-l-2 font-bold shadow-lg":a.id===n,"hover:bg-blue-50 font-normal":a.id!==n})}`,children:s("div",{className:"w-full  flex items-center text-sm border-gray-300 border-b py-1",children:[s("span",{className:" mr-2  ",children:[k+1,"."]}),e("span",{className:`${y({"text-red-500":((p=o||[])==null?void 0:p.filter(g=>g.entityType===a.type&&g.unpublishForm!==null).length)>0})} flex flex-1`,children:a.title||a.type}),e("span",{className:"text-xs flex items-end ",children:a.type})]})},a.id)})]}):e(N,{}),[o,n]);return s("div",{className:"w-80 ml-2 my-2 flex flex-col bg-white border rounded-md flex-shrink-0 ",children:[e(H,{id:"modelSiderPage"}),s("div",{className:" flex items-center px-4 py-2 h-16 w-full  border-b  border-dashed border-gray-400",children:[e("div",{className:" bg-blue-400 rounded h-7 w-7 flex justify-center items-center  mr-4",children:e("i",{className:"text-xl text-white icon-access_time "})}),s("div",{className:" flex-1 flex-col flex ",children:[e("span",{className:"font-bold",children:(b=r==null?void 0:r.find(l=>l.id===(t==null?void 0:t.appId)))==null?void 0:b.name}),e("div",{className:" text-gray-400 text-sm",children:"模型管理"})]}),s("div",{className:" items-center justify-center flex space-x-2   ",children:[e("span",{id:"step4",children:e(B,{app:r==null?void 0:r.find(l=>l.id===(t==null?void 0:t.appId))})}),s("span",{id:"step5",children:[e(u,{render:s(u.Menu,{children:[e(u.Title,{children:"应用切换"}),r==null?void 0:r.filter(l=>l.id!==(t==null?void 0:t.appId)).map(l=>e(u.Item,{onClick:()=>{f(`/modelDesign/detail?appId=${l.id}`)},children:l.name},l.id))]}),children:e("i",{className:" icon-change-member text-3xl text-gray-500 cursor-pointer hover:text-blue-500 "})})," "]})]})]}),e(U,{children:s("div",{className:"flex flex-col flex-1 ",children:[h({list:(d==null?void 0:d.filter(l=>l.state==="creating"))||[],icon:e("i",{className:" icon-start_time"}),label:"创建中",desc:"请完善字段后提交",className:" bg-blue-500 "}),h({list:(d==null?void 0:d.filter(l=>l.state==="restart"||l.state==="wait_start"))||[],label:"待重启",desc:"请重启Java服务",icon:e("i",{className:" icon-sp_hydropower_coal_white"}),className:"bg-yellow-500"}),h({list:(d==null?void 0:d.filter(l=>l.state==="published"))||[],label:"运行中",desc:"已发布的模型",icon:e("i",{className:"  icon-done"}),className:"bg-green-400"})]})})]})},{Content:q}=W,ne=()=>{const{pathname:i}=T(),f=c.useMemo(()=>{if(i.endsWith("/detail"))return"模型详情";if(i.endsWith("/entity"))return"实体模型设计";if(i.endsWith("/dto"))return"DTO模型设计"},[i]);return s("div",{className:"w-full h-full flex flex-col ",children:[e(A,{title:"模型设计",secondTitle:f}),s("div",{className:" flex w-full flex-1 ",children:[e(J,{}),e(q,{className:"layout-content bg-gray-50",children:e(c.Suspense,{fallback:e(_,{message:"正在加载中"}),children:e(j,{})})})]}),e(L,{}),e(O,{}),e(P,{})]})};export{ne as default};
