import{r as n,j as m,c as d,d as s,u as y}from"./index-BNDtW2eT.js";import{r as b,V as N,S as v,C as u,s as S,d as P,a as I}from"./ChartPageDesign-D5WcnOiz.js";import{u as D}from"./index-QG4shP5G.js";import{b as T}from"./SysMenu-CgEQZZD1.js";import"./index-DtUS3qWu.js";import"./index-C6DPW6pI.js";import"./index-DQz7rEVH.js";import"./index-B-XWCHoo.js";import"./formPage-BHPYqPSB.js";import"./SysApp-rYatu4bx.js";import"./index-CXoj0GaU.js";import"./useEffectWithTarget-aARMLXxS.js";import"./BasicTable-DviIzjgY.js";import"./Tabs-8Y1H_XcO.js";import"./GroupButton-D5eFJVxs.js";import"./TableHeader-OG3ax13l.js";import"./vlifeModal-DhFQGOhg.js";const L=b.WidthProvider(b.Responsive),x=t=>u[t.component].componentType==="filter",j=({pageConf:t,onBack:r})=>{var c;const[a,i]=n.useState(),o=n.useMemo(()=>{var e;return(t==null?void 0:t.pageType)==="chartPage"&&((e=t==null?void 0:t.content)==null?void 0:e.some(l=>x(l)))||!1},[t]);return m("div",{className:` relative  ${d({"bg-slate-800":t==null?void 0:t.bigScreen})}
    flex-1 overflow-y-auto overflow-x-hidden absolute inset-0 h-full pr-1 `,children:[(!(t!=null&&t.content)||(t==null?void 0:t.content.length)===0)&&s("div",{onClick:r,className:"flex justify-center items-center h-full",children:s("h2",{className:"bg-blue-400 text-white font-bold text-xl p-4 rounded shadow-lg cursor-pointer transition-all duration-300 hover:bg-blue-500 hover:shadow-xl hover:scale-105",children:"开始配置"})}),s(L,{className:"layout",margin:[0,0],rowHeight:2,allowOverlap:(t==null?void 0:t.componentOver)===!0,isResizable:!1,isDraggable:!1,children:(c=t==null?void 0:t.content)==null?void 0:c.map((e,l)=>s("div",{id:e.pageKey,style:{zIndex:e.i},"data-grid":{...e},className:d({"pl-1 pt-1":t.border}),children:t.border&&!x(e)?s(N,{title:e.name,more:e.more,mode:"view",bigScreen:t.bigScreen,children:(o&&a||o==!1)&&s(v,{card:!0,className:d("h-full"),pageComponentDto:e,h:e.h,conditions:a,onConditionsChange:i,bigScreen:t.bigScreen,compInfo:u[e.component]})}):s(v,{card:!1,className:d("h-full"),pageComponentDto:e,h:e.h,conditions:a,onConditionsChange:i,bigScreen:t.bigScreen,compInfo:u[e.component]})},e.pageKey||"comp"+l))},t==null?void 0:t.id)]})},R=({design:t,setDesign:r,className:a="right-2 bottom-2 absolute"})=>{const i=d("border-blue-500 animate-pulse hover:!animate-none hover:shadow-lg transition-shadow duration-300 bg-gradient-to-r p-2 w-12 h-12 text-center cursor-pointer text-white text-xl font-extrabold rounded-lg shadow-lg",{"from-blue-500 to-purple-600":!t,"from-blue-500 to-green-600":t});return m("div",{className:`${a} z-50`,children:[s("div",{onClick:()=>r(!t),className:i,children:s("i",{className:t?"icon-pic":"icon-setting"})}),s("div",{className:"text-xs w-full text-center text-blue-500 font-bold",children:t?"返回":"设置"})]})},Q=()=>{const{user:t,menu:r,setMenu:a}=y(),[i,o]=n.useState(),[c,e]=n.useState(!1);return n.useEffect(()=>{r&&r.pageType==="chartPage"&&(r.pageLayoutId?P({urlOrId:r.pageLayoutId}).then(l=>{o(l.data)}):S({border:!0,pageType:"chartPage",name:r.name}).then(l=>{var h;o(l.data),r.pageLayoutId=(h=l.data)==null?void 0:h.id,T(r).then(w=>{a(w.data)})}))},[r==null?void 0:r.id]),D((r==null?void 0:r.name)||"图表看板"),m("div",{className:"w-full h-full relative",children:[i&&(c?s(I,{dto:i,chartComponents:u,onSave:o,onClose:()=>e(!1)},i.id):s(j,{onBack:()=>{e(!0)},pageConf:i})),(t==null?void 0:t.superUser)&&s(R,{design:c,setDesign:e})]})};export{Q as default};
