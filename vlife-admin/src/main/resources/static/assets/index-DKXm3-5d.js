import{u as _,a as J,b as Z,r as c,j as b,c as F,d as e,E as pe,F as me,B as U,e as he,s as fe,f as ye,g as ee,h as ge,i as te,T as be,S as ve,O as Te}from"./index-SxAtwMns.js";import{N as V,L as O}from"./index-BS1aA8mM.js";import{l as xe}from"./logo2-DYc4F8xQ.js";import{A as ie}from"./index-Kh_0iifu.js";import{D as R,I as we}from"./index-OY_QAQ2f.js";import{B,I as Ne,a as Se,S as Ie,b as se,c as Pe,d as oe,u as le,e as ke,N as re}from"./index-BLqHf6AC.js";import{V as l,B as Q,u as j,l as Ce,F as ce,s as Me}from"./formPage-DEYoTnuZ.js";import{L as Ee}from"./LinkMe-D91eQV7k.js";import{l as $e,e as Ae,r as De,c as Fe}from"./SysApp-BMXU6j0c.js";import{s as W,a as ne,r as ze}from"./SysMenu-rcqQTehU.js";import{G as Ke}from"./GroupButton-C-osmH_b.js";import{m as q}from"./static-wPmgQVRS.js";import{v as Le}from"./vlifeModal-Qh_zqYFu.js";import"./toInteger-uMFPjwcp.js";import"./index-DtzUPu3w.js";const Re=[l.then("app").value(!0).hide(),l.then("url","formId","pcode","pageType","pageLayoutId","formType","entityType").hide().clearValue(),l.field("id").isNotNull().then("appKey").readPretty(),l.then("icon").required(),l.then("appKey").required(),l.field("appKey").regex(/^[a-z]+$/).then("appKey").feedback("需小写字母(作为类的包名)"),l.then("appKey").description(i=>i.appKey&&`服务端代码将创建在cn.vlife.${i.appKey}包下`),l.then("name").title("应用名称")];l.then("app","appKey","code","pcode","url","sort","pageType","pageLayoutId","formType","entityType","formId").hide(),l.then("name").title("分组名称");const Ue=[l.then("app","appKey","code","pcode","url","sort","pageType","pageLayoutId").hide(),l.field("id").isNotNull().then("entityType","formType").readPretty(),l.then("name").title("菜单名称"),l.field("entityType").isNotNull().then("formType").show(),l.then("entityType").required(),l.field("entityType").change().then("formType").clearValue(),l.then("icon").title("菜单图标"),l.then("url").value("/table/*"),l.then("pageType").value("crudPage")],Oe=[l.then("app","appKey","code","pcode","url","sort","pageType","formType","entityType","formId","pageLayoutId").hide(),l.then("name").title("菜单名称"),l.then("icon").title("菜单图标"),l.then("formId").hide().clearValue(),l.then("url").value("/chart/*"),l.then("pageType").value("chartPage")],Be=[l.then("app","appKey","code","pcode","sort","formId","pageType","formType","entityType","pageLayoutId").hide(),l.then("pageType").value("customPage"),l.then("name").title("菜单名称"),l.then("icon").title("菜单图标")],je=(i,t)=>{const m=i.filter(r=>r.sysAppId===t),u=m.filter(r=>!r.pcode).sort((r,T)=>r.sort-T.sort),p=r=>{if(r.url)return r.url.endsWith("*")?r.url.substring(0,r.url.length-1)+r.id:r.url};for(const r of u){const T=p(r);if(T)return{...r,url:T};const N=m.filter(h=>h.pcode===r.code).sort((h,$)=>h.sort-$.sort).find(h=>h.url);if(N){const h=p(N);if(h)return{...N,url:h}}}},He={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_API_URL:"",VITE_APP_MODE:"pro",VITE_APP_PAGESIZE:"15",VITE_APP_SAVE_REMOVE:"true",VITE_APP_TITLE:"vlife快速研发平台",VITE_APP_VERSION:"free"},Ge="",{Header:We}=O,{VITE_APP_API_URL:qe}=He;function de(i){return i?typeof i=="string"?e("div",{className:"h-full flex items-center",children:e(Ie,{readPretty:!0,value:i})}):i.render():null}const Ve=()=>{const{loginOut:i,user:t,setApp:m,app:u,menu:p,setMenu:r,datasInit:T,sysVar:N}=_(),h=J(),$=Z(),{pathname:d}=$,[f,S]=c.useState(),P=c.useCallback(()=>{$e().then(y=>{var M;const a=[...new Set(t==null?void 0:t.menus.map(x=>x.sysAppId))],g=(M=y.data)==null?void 0:M.filter(x=>(t==null?void 0:t.superUser)||a.includes(x.id)).sort((x,A)=>x.sort-A.sort);S(g)})},[t==null?void 0:t.menus.map(y=>y.sysAppId).join("")]);c.useEffect(()=>{P()},[t==null?void 0:t.menus.map(y=>y.sysAppId).join("")]),c.useEffect(()=>{var y,a;if(!p&&!u&&f&&f.length>0){if(d==="/"||d==="")m(f[0]);else if(d){let g=(a=(y=t==null?void 0:t.menus)==null?void 0:y.filter(M=>M.url===d||d.endsWith(M.id)))==null?void 0:a[0];g!==void 0?(m(f==null?void 0:f.find(M=>M.id===(g==null?void 0:g.sysAppId))),r(g)):m(f[0])}}},[d,f]);const I=c.useMemo(()=>(f==null?void 0:f.map(a=>({itemKey:a.id,icon:de(a.icon),onClick:()=>{a.id!==(u==null?void 0:u.id)&&m(a)},text:b("div",{className:`${F({" text-blue-500 ":(u==null?void 0:u.id)===a.id})} z-10 flex !items-center relative  hover:text-blue-500 `,children:[e("span",{children:a.name}),(t==null?void 0:t.superUser)&&e("div",{className:"!z-20",onClick:g=>{g.cancelable=!0,g.stopPropagation()},children:e(Q,{dropdown:!0,onDataChange:()=>{T("menu")},btns:[{title:"编辑应用",saveApi:Ae,model:"sysApp",actionType:"edit",reaction:Re,submitClose:!0,datas:a,onSubmitFinish:()=>{P()}},{title:"删除应用",saveApi:De,actionType:"api",multiple:!0,datas:a,usableMatch:g=>(t==null?void 0:t.menus.filter(M=>{var x;return M.sysAppId===((x=g==null?void 0:g[0])==null?void 0:x.id)}).length)>0?"应用下有模块不能删除":!0,onSubmitFinish:()=>{P()}}]},`app_${a.id}`)})]},`app_${a.id}`)})))||[],[f,d,u]);return e(We,{className:"layout-header shadow",children:e(V,{mode:"horizontal",header:e("div",{className:" flex !items-center cursor-pointer ",onClick:()=>{h("/dashboard")},style:{width:160,height:30,top:10},children:N!=null&&N.icon?e("img",{src:Ge+"/sysFile/image/"+N.icon,style:{width:160,height:40,top:10}}):e(pe,{className:" relative top-3  mr-4",image:e("img",{src:xe,style:{width:160,height:40,top:10}})})}),selectedKeys:[(u==null?void 0:u.id)||""],items:I,footer:b(me,{children:[(t==null?void 0:t.superUser)&&b("div",{className:"flex",children:[e(B,{theme:"solid",className:" h-full items-center   ",title:"创建应用",icon:e("i",{className:"  icon-task_add-02"}),actionType:"create",model:"sysApp",allowEmpty:!0,submitClose:!0,saveApi:Fe,reaction:[l.then("appKey").description(y=>y.appKey&&`服务端代码将创建在cn.vlife.${y.appKey}包下`),l.then("sort").value(((f==null?void 0:f.length)||0)+1)],onSubmitFinish:(...y)=>{m(y[0]),S(a=>[...a||[],y[0]]),T("menu"),h(`/design/modelDesign?appId=${y[0].id}&modelId=undefined`)}},`createApp_${d}`),e(U,{theme:"borderless",onClick:()=>{h(`/design/modelDesign${u&&`?appId=${u.id}`}`)},style:{color:"var(--semi-color-text-2)"},icon:e("i",{className:"icon-settings text-xl text-indigo-500"}),children:"模型管理"}),e(U,{theme:"borderless",className:"2xl:!block !hidden",style:{color:"var(--semi-color-text-2)"},onClick:()=>{h("/vlife/common/iconContainer")},icon:e("i",{className:"icon-descending-order2 text-xl"}),children:"图标库"}),e(Ee,{}),e(U,{theme:"borderless",className:"2xl:!block !hidden",icon:e(Ne,{size:"large"}),style:{color:"var(--semi-color-text-2)",marginRight:"12px"},onClick:()=>{window.open("http://vlife.cc")},children:"官网"}),e(U,{theme:"borderless",className:"2xl:!block !hidden",icon:e(Se,{size:"large"}),style:{color:"var(--semi-color-text-2)",marginRight:"12px"},onClick:()=>{window.open("https://gitee.com/wwwlike/vlife")},children:"GITEE"})]}),e("div",{className:" m-2 !text-sm !text-blue-300 font-medium cursor-pointer",onClick:()=>{window.open("http://vlife.cc")},children:"vlife基础版"}),e(R,{position:"bottomLeft",render:b(R.Menu,{children:[b(R.Item,{onClick:i,children:[e("i",{className:"  icon-exit_to_app mr-2"}),e("span",{children:"退出登录"})]}),b(R.Item,{children:[e("i",{className:"  icon-limit-othermember mr-2"}),e(B,{btnType:"link",loadApi:he,model:"sysUserDto",actionType:"edit",reaction:[l.then("name","username","sysDeptId","sysUserGroup_sysGroupId").readPretty(),l.then("superUser","state").hide()],datas:{id:t==null?void 0:t.id},allowEmpty:!0,saveApi:fe,title:"基本信息"})]}),b(R.Item,{children:[e("i",{className:"  icon-password mr-2"}),e(B,{btnType:"link",datas:{id:t==null?void 0:t.id},model:"userPasswordModifyDto",actionType:"edit",submitClose:!0,saveApi:ye,onSubmitFinish:y=>{i()},title:"密码修改"})]})]}),children:t!=null&&t.avatar?e(ie,{alt:"beautiful cat",size:"small",src:`${qe}/sysFile/image/${t==null?void 0:t.avatar}`,style:{margin:4}}):e(ie,{color:"orange",size:"small",children:t==null?void 0:t.name[0]})})]})})})},_e=[{label:"表单页面",desc:"用于填写、查询数据",icon:e("i",{className:"icon-rename_input text-4xl"}),key:"crudPage"},{label:"分析页面",desc:"用于分析、可视化展现数据",icon:e("i",{className:" icon-stats_funnel_chart text-4xl"}),key:"chartPage"},{label:"二开页面",desc:"自行开发的页面功能接入",icon:e("i",{className:" icon-workflow_write text-4xl"}),key:"customPage"}],ae=({onChange:i,onForm:t,pcode:m,appId:u})=>{const[p,r]=ee.useState("crudPage"),{model:T}=j({type:"sysMenu"}),{model:N}=j({type:"menuCrudDto"}),[h,$]=ee.useState();c.useEffect(()=>{i&&h&&i(h)},[h]);const[d,f]=c.useState(0);return c.useEffect(()=>{Ce({req:{appId:u,itemType:"entity"}}).then(S=>{var P;f(((P=S.data)==null?void 0:P.filter(I=>I.state!=="creating").length)||0)})},[]),c.useMemo(()=>p==="crudPage"?[...Ue,l.then("pcode").value(m),l.result(d===0).then("entityType").feedback("当前没有任何发布的实体")]:p==="chartPage"?[...Oe,l.then("pcode").value(m)]:p==="customPage"?[...Be,l.then("pcode").value(m)]:[],[p,m]),b("div",{className:"w-full h-full space-x-4 flex-col",children:[e("div",{className:"w-full flex h-24 space-x-4",children:_e.map((S,P)=>b("div",{onClick:()=>r(S.key),className:`${F({"border-blue-500 bg-blue-50 hover:bg-blue-50":p===S.key,"border-gray-300":p!==S.key})} relative block w-1/3 cursor-pointer  border-2 border-dashed rounded-lg  text-center hover:border-blue-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500`,children:[S.icon,e("span",{className:"mt-1 block text-sm font-bold text-gray-900",children:S.label}),e("span",{className:"mt-1 block text-sm font-medium text-gray-500",children:S.desc})]},P))}),b("div",{className:" flex flex-1  p-4",children:[T&&p==="crudPage"&&e(ce,{fieldOutApiParams:{formId:{conditions:ge({appId:u})}},formData:{sysAppId:u,pageType:p,pcode:m},terse:!0,formSetting:!0,onForm:t,reaction:[],className:"w-full",onChange:$,modelInfo:N},p),p==="chartPage"&&e("div",{className:"flex w-full  h-20 justify-center items-center text-blue-500  font-medium",children:"请升级到专业版以上"}),p==="customPage"&&e("div",{className:"flex w-full  h-20 justify-center items-center text-blue-500  font-medium",children:"开发人员通过自定义页面实现复杂功能，需要升级后使用"})]})]})},{Sider:Je}=O,Ze=()=>{var A,z,E;const{user:i,app:t,setMenu:m,menu:u,datasInit:p}=_(),r=J(),{getModel:T}=j(),{pathname:N}=Z(),[h,$]=c.useState([]),[d,f]=c.useState([]),[S,P]=c.useState(window.innerHeight),[I,y]=c.useState({}),a=c.useMemo(()=>{var k,C;const n=((k=i==null?void 0:i.menus.filter(s=>!!s.url))==null?void 0:k.slice(0,q).map(s=>s.id))||[];return i!=null&&i.menus&&t?(C=i.menus)==null?void 0:C.filter(s=>(s==null?void 0:s.sysAppId)===t.id).filter(s=>!s.url||s.sys===!0||n.includes(s.id)):[]},[i==null?void 0:i.menus,t]);c.useEffect(()=>{a.filter(n=>n.pageType==="crudPage").forEach(n=>{T({id:n.formId}).then(k=>{y(C=>({...C,[n.formId]:k==null?void 0:k.state}))})})},[a]),c.useEffect(()=>{if(!u&&a&&t){const n=je(a,t.id);n&&(m(n),r(n==null?void 0:n.url))}},[u,a,t]);const g=c.useCallback(n=>{var k;if(n.selectedItems&&((k=n.selectedItems[0])!=null&&k.path)){const C=n.selectedItems[0].id,s=i==null?void 0:i.menus.find(o=>o.id===C);m(s),f([C]),r(n.selectedItems[0].path)}},[i==null?void 0:i.menus]),M=n=>{$([...n.openKeys])};c.useEffect(()=>{u&&(!d||d.length===0||!d.includes(u.id))&&f([u==null?void 0:u.id]),$(a.filter(n=>!n.url).map(n=>n.id))},[u,d,i==null?void 0:i.menus,a,t==null?void 0:t.id]);const x=c.useMemo(()=>{const n=(k,C)=>a.sort((s,o)=>s.sort-o.sort).filter(s=>s.pcode===(C?null:k==null?void 0:k.code)).map(s=>({id:s.id,itemKey:s.id,isLocked:!!s.pageType,text:i!=null&&i.superUser?b("div",{className:" group z-10 flex items-center relative w-28",children:[b("div",{className:"z-10 flex  w-full  items-center ",children:[e("div",{className:"flex items-center ",children:s.name}),s.pageType==="crudPage"&&I[s.formId]!=="published"&&e(be,{content:"可以访问，正常使用需重启服务",children:e("i",{className:" icon-replay flex items-center absolute right-6  text-red-500"})})]}),b("div",{className:"flex absolute items-center right-0 !z-20 ",onClick:o=>{o.cancelable=!0,o.stopPropagation()},children:[e(Q,{dropdown:!0,datas:[s],className:F({"hidden group-hover:block":!d.includes(s.id)}),btns:[{title:(s==null?void 0:s.pageType)==="crudPage"?"编辑菜单":"菜单授权",icon:e(se,{size:"small",className:"z-20"}),actionType:"edit",disabledHide:!0,reaction:[l.field("pageType").eq("chartPage").then("formId").hide(),l.field("pageType").ne("chartPage").then("groupIds").hide()],disabled:s.pageType!=="crudPage"&&s.pageType!=="chartPage",model:"menuCrudDto",saveApi:W,onSubmitFinish:(...o)=>{p("menu")}},{title:"模型设计",icon:e("i",{className:"  icon-shareLink"}),actionType:"click",disabledHide:!0,disabled:s.pageType!=="crudPage",onClick:()=>{r(`/design/modelDesign?appId=${t==null?void 0:t.id}&modelId=${s.formId}`)}},{title:"表单设计",icon:e("i",{className:"  icon-construction"}),actionType:"click",disabledHide:!0,disabled:s.pageType!=="crudPage",onClick:()=>{r(`/full/formDesign/${s.formId}`)}},{title:"编辑分组",icon:e(se,{size:"small",className:"z-20"}),actionType:"edit",disabledHide:!0,disabled:!(!s.pcode&&!s.url&&s.pageType!=="crudPage"&&s.pageType!=="chartPage"),model:"menuGroupDto",saveApi:ne,onSubmitFinish:(...o)=>{p("menu")}},{title:s.url?"删除菜单":"删除分组",actionType:"api",icon:e(Pe,{size:"small",className:"z-20"}),saveApi:(...o)=>ze([s.id]),submitConfirm:!0,onSubmitFinish:(...o)=>{p("menu").then(()=>{m(void 0)})},usableMatch:()=>{var o;return s.sys===!0?"系统级菜单不允许删除":((o=i.menus)==null?void 0:o.filter(H=>H.pcode===s.code).length)>0?"分组下有菜单不能删除":!0}}]},s.id+JSON.stringify(d)),!s.pcode&&!s.url&&e(B,{title:"添加子菜单",btnType:"icon",icon:e("i",{className:"  icon-task_add-02"}),actionType:"modal",modal:e(ae,{pcode:s.code,appId:C==null?void 0:C.id}),saveApi:W,submitClose:!0,onSubmitFinish:o=>{p("btn"),p("menu").then(()=>{f([o.data.id]),o.data.pageType==="crudPage"?r(`/table/${o.data.id}`):o.data.pageType==="chartPage"?r(`/chart/${o.data.id}`):r(`${o.data.url}`)})}},s.id+N)]})]},s.id):e("div",{onClick:()=>{m(s)},children:s.name},s.id),code:s.code,icon:s.icon?de(s.icon):null,path:s.url&&s.url.endsWith("*")?s.url.substring(0,s.url.length-1)+s.id:s.url,items:n(s,null)}));return t&&a?n(null,t):[]},[a,t,d,i==null?void 0:i.menus,N,I]);return c.useEffect(()=>{const n=()=>{P(window.innerHeight)};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[]),e(Je,{children:e(V,{toggleIconPosition:i!=null&&i.superUser?"left":"right",bodyStyle:{height:`${S-110}px`},className:"!overflow-y-auto relative  !z-10  ",items:x&&x.length>0?x:[],openKeys:h&&h.length>0?h:[(A=x==null?void 0:x[0])==null?void 0:A.id],selectedKeys:d,onSelect:g,onOpenChange:M,style:{maxWidth:220,height:"100%"},onCollapseChange:n=>{},children:e(V.Footer,{collapseButton:!0,className:" !absolute !bottom-0   items-center justify-between  flex  w-full",children:(t==null?void 0:t.id)&&(i==null?void 0:i.superUser)&&b("div",{className:` flex group items-center  ${F({"absolute bottom-96 ":a.length===0})}  w-full  h-full  justify-center`,children:[e(Ke,{className:`${F({"flex flex-col space-y-2 items-center justify-center":a.length===0," grid-cols-2 grid gap-y-2":a.length!=0})}
                  `,btns:[{icon:e("i",{className:"icon-add_circle"}),title:"建模",theme:"solid",actionType:"create",model:"form",submitClose:!0,reaction:[l.then("sysAppId").value(t==null?void 0:t.id).readPretty(),l.then("itemType").value("entity")],onSaveBefore:n=>(n.type=te(n.type),n.entityType=te(n.type),n),disabledHide:!0,saveApi:Me,onSubmitFinish:n=>{r(`/design/modelDesign?appId=${t==null?void 0:t.id}&modelId=${n.id}`)}},{title:"菜单",icon:e("i",{className:"  icon-task_add-02"}),actionType:"modal",modal:e(ae,{appId:t.id}),disabled:((z=i==null?void 0:i.menus)==null?void 0:z.filter(n=>!!n.url).length)>q,disabledTooltip:"已到达菜单数量上限,升级到标准版以上无限制",saveApi:W,submitClose:!0,onSubmitFinish:n=>{p("btn").then(()=>{p("menu").then(()=>{m(n.data),n.data.pageType==="crudPage"?r(`/table/${n.data.id}`):n.data.pageType==="chartPage"?r(`/chart/${n.data.id}`):r(`${n.data.url}`)})})}},{icon:e("i",{className:"icon-add_circle"}),title:"分组",model:"menuGroupDto",saveApi:ne,actionType:"create",initData:{sysAppId:t.id},submitClose:!0,onSubmitFinish:()=>{p("menu")}},{title:"排序",disabledHide:!0,disabled:a.length<=1,allowEmpty:!0,icon:e("i",{className:" text-blue-500 icon-task-folder-slide-sort text-sm"}),actionType:"click",onClick:()=>{r("/vlife/sysMenu")}}]}),b("div",{className:" absolute -top-4 text-xs group-hover:block hidden text-red-400",children:["还可创",q-((E=i==null?void 0:i.menus)==null?void 0:E.filter(n=>!!n.url).length),"个菜单，升级后无限制"]})]},t==null?void 0:t.id)})})})},Qe=oe("formModal",({modelInfo:i,formData:t,width:m,activeKey:u,onError:p,formDesign:r=!1,btns:T,modifyData:N,...h})=>{var Y;const $=le("formModal"),[d,f]=c.useState({width:window.screen.width,height:window.screen.height}),S=J(),{user:P}=_(),[I,y]=c.useState((Y=T==null?void 0:T[0])==null?void 0:Y.continueCreate),[a,g]=c.useState(t),[M,x]=c.useState(0),[A,z]=c.useState();c.useEffect(()=>{z(N)},[N]);const[E,n]=c.useState(),[k,C]=c.useState([]),{model:s}=j(i?{}:{type:h.type}),o=i||s,H=c.useMemo(()=>{var L;const v=(a==null?void 0:a.no)||"";if(h.title)return h.title;if(o===void 0)return`“${h.type}”模型标识不存在`;const w=(o==null?void 0:o.title)||o.type;return h.readPretty?w+"详情"+v:(L=E==null?void 0:E.values)!=null&&L.id?w+v:"新建("+w+")"},[a,E,o]),D=c.useMemo(()=>T&&E?T.map(v=>({...v,btnType:"button",position:"formFooter",datas:{...a},onSubmitFinish:w=>{I===!0||I===void 0&&v.continueCreate===!0?(g(void 0),x(L=>L+1)):(g(w),z(w)),v.onSubmitFinish&&v.onSubmitFinish(w)},onFormilySubmitCheck:()=>E.submit().then(w=>!0).catch(w=>!1)})):[],[T,E,o,a,I]),G=D.filter(v=>v.actionType==="create"&&v.continueCreate!==void 0),ue=c.useMemo(()=>D&&D.length>0?b("div",{className:"flex w-full justify-end relative h-full items-center  space-x-1",children:[r===!1&&(P==null?void 0:P.superUser)===!0&&b("div",{onClick:()=>{S(`/full/formDesign/${o.type}`)},className:" flex flex-1 hover:text-blue-500  font-normal space-x-2  items-center justify-start cursor-pointer",children:[e(we,{size:"small"}),e("span",{children:"表单配置"})]}),G.length>0&&b("div",{className:"absolute flex left-2 items-center",children:[e("span",{className:`text-gray-400 ${F({"!text-gray-800":I!==void 0?I:G[0].continueCreate})}`,children:"连续新增"}),e(ke,{checked:I!==void 0?I:G[0].continueCreate,onChange:v=>{y(v)},checkedText:"开",uncheckedText:"关"})]}),D.length>0?e(Q,{datas:[(a==null?void 0:a.flow)!==void 0?a:{...a}],btns:D.map(v=>({...v,modalOpen:!0})),entity:i==null?void 0:i.entityType,activeKey:u,dataType:i==null?void 0:i.type,position:"formFooter",btnType:"button"}):e(U,{onClick:()=>{$.hide()},children:"关闭"})]}):e("div",{}),[D,a,E,I]),K=c.useMemo(()=>d.width<=1280?1:d.width<=1600?.9:d.width<=1920?.8:d.width<=2560?.65:d.width<=3840?.55:d.width<=5120?.45:.4,[d]),X=c.useMemo(()=>{if(m)return m;let w=0;return(o==null?void 0:o.modelSize)===4&&(w=d.width*.9*K),(o==null?void 0:o.modelSize)===3&&(w=d.width*.75*K),(o==null?void 0:o.modelSize)===2&&(w=d.width*.6*K),(o==null?void 0:o.modelSize)===1&&(w=d.width*.3*K),w<100?100:w},[m,d.width,o,K]);return e(re,{id:"formModal",closeOnEsc:!0,footer:ue,title:H,width:d.width>X?X:d.width,children:e(ce,{formSetting:!0,atModal:!0,onError:C,formData:a,modelInfo:o,modifyData:A,onChange:(v,w)=>{g(L=>({...v}))},onForm:v=>{n(v)},...h},`${M}${o==null?void 0:o.id}`)})}),Xe=oe("confirmModal",({saveFun:i,title:t="确认删除选中的记录么?"})=>{const m=le("confirmModal"),u=c.useCallback(()=>{if(i){const p=i();if(p instanceof Promise)return p.then(r=>m.resolve(r)).finally(()=>{m.hide()});setTimeout(()=>m.resolve(p),500)}},[i]);return e(re,{id:"confirmModal",title:"操作确认",width:350,onOk:u,children:e("p",{children:t})})}),{Content:Ye}=O,ft=()=>{const{pathname:i}=Z(),t=i.includes("/full/");return b(O,{className:"layout-page",children:[!t&&e(Ve,{}),b(O,{children:[!t&&e(Ze,{}),e(Ye,{className:"layout-content bg-gray-50",children:e(c.Suspense,{fallback:e(ve,{message:"正在加载中"}),children:e(Te,{})})})]}),e(Qe,{}),e(Xe,{}),e(Le,{})]})};export{ft as default};
