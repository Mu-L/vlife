import{r as c,j as v,c as u,d as s,u as D,b as L,h as R}from"./index-ClvCGvy-.js";import{r as w,V as j,S,C as h,s as M,d as k,a as z}from"./ChartPageDesign-DeVwX49f.js";import{u as E}from"./index-BnDqpt9O.js";import{l as O,b as V}from"./SysMenu-JRyd2A4Z.js";import"./index-BjJwmxgB.js";import"./index-BxbY9JGq.js";import"./index-Wlwe5g9P.js";import"./toInteger-DzTPojnH.js";import"./index-C5OWF-D0.js";import"./index-p5CuCj6W.js";import"./formPage-D8ezj0WE.js";import"./SysApp-Crr6z53s.js";import"./index-BCvCVhRJ.js";import"./BasicTable-C2QRvdIX.js";import"./Tabs-CTns7yZQ.js";import"./GroupButton-lOBvLqtf.js";import"./static-wPmgQVRS.js";import"./TableHeader-CBn3u5no.js";import"./vlifeModal-C1ynfrxG.js";const p=w.WidthProvider(w.Responsive),N=t=>h[t.component].componentType==="filter",B=({pageConf:t,onBack:i})=>{var d;const[r,l]=c.useState(),n=c.useMemo(()=>{var e;return(t==null?void 0:t.pageType)==="chartPage"&&((e=t==null?void 0:t.content)==null?void 0:e.some(o=>N(o)))||!1},[t]);return v("div",{className:` relative  ${u({"bg-slate-800":t==null?void 0:t.bigScreen})}
    flex-1 overflow-y-auto absolute inset-0  h-full `,children:[(!(t!=null&&t.content)||(t==null?void 0:t.content.length)===0)&&s("div",{onClick:i,className:"flex justify-center items-center h-full",children:s("h2",{className:"bg-blue-400 text-white font-bold text-xl p-4 rounded shadow-lg cursor-pointer transition-all duration-300 hover:bg-blue-500 hover:shadow-xl hover:scale-105",children:"开始配置"})}),s(p,{className:"layout",margin:[0,0],rowHeight:2,allowOverlap:(t==null?void 0:t.componentOver)===!0,isResizable:!1,isDraggable:!1,children:(d=t==null?void 0:t.content)==null?void 0:d.map((e,o)=>s("div",{id:e.pageKey,style:{zIndex:e.i},"data-grid":{...e},className:u({"pl-1 py-1":t.border}),children:t.border&&!N(e)?s(j,{title:e.name,more:e.more,bigScreen:t.bigScreen,children:(n&&r||n==!1)&&s(S,{card:!0,className:u("h-full"),pageComponentDto:e,h:e.h,conditions:r,onConditionsChange:l,bigScreen:t.bigScreen,compInfo:h[e.component]})}):s(S,{card:!1,className:u("h-full"),pageComponentDto:e,h:e.h,conditions:r,onConditionsChange:l,bigScreen:t.bigScreen,compInfo:h[e.component]})},e.pageKey||"comp"+o))},t==null?void 0:t.id)]})},G=({design:t,setDesign:i,className:r="right-2 bottom-2 absolute"})=>{const l=u("border-blue-500 animate-pulse hover:!animate-none hover:shadow-lg transition-shadow duration-300 bg-gradient-to-r p-2 w-12 h-12 text-center cursor-pointer text-white text-xl font-extrabold rounded-lg shadow-lg",{"from-blue-500 to-purple-600":!t,"from-blue-500 to-green-600":t});return v("div",{className:`${r} z-50`,children:[s("div",{onClick:()=>i(!t),className:l,children:s("i",{className:t?"icon-pic":"icon-setting"})}),s("div",{className:"text-xs w-full text-center text-blue-500 font-bold",children:t?"返回":"设置"})]})},st=()=>{const{user:t}=D(),[i,r]=c.useState(),[l,n]=c.useState(),[d,e]=c.useState(!1),o=L();return c.useEffect(()=>{e(!1);const I=o.pathname.split("/").length,P=o.pathname.split("/")[I-1];O({conditions:R({id:P})}).then(b=>{var x;const a=(x=b==null?void 0:b.data)==null?void 0:x[0];n(a),a&&a.pageType==="chartPage"&&(a.pageLayoutId?k({urlOrId:a.pageLayoutId}).then(m=>{r(m.data)}):M({border:!0,pageType:"chartPage",name:a.name}).then(m=>{var y;r(m.data),a.pageLayoutId=(y=m.data)==null?void 0:y.id,V(a).then(T=>{n(T.data)})}))})},[o]),E((l==null?void 0:l.name)||"图表看板"),v("div",{className:"w-full h-full relative",children:[i&&(d?s(z,{dto:i,chartComponents:h,onSave:r,onClose:()=>e(!1)},i.id):s(B,{onBack:()=>{e(!0)},pageConf:i})),(t==null?void 0:t.superUser)&&s(G,{design:d,setDesign:e})]})};export{st as default};
