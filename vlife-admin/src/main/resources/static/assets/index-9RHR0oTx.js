import{c as m,r as d,l as h,k as o,f as v,D as P}from"./index-zu87m18r.js";import{V as e}from"./VF-CFm92MRs.js";import{u as g,l as N}from"./GroupLabel-CFJ4I-sR.js";import{F as k}from"./formPage-D0LEgB12.js";const A=[e.then("app").value(!0).hide(),e.then("url","formId","pcode","pageType","pageLayoutId","formType","entityType").hide().clearValue(),e.field("id").isNotNull().then("appKey").readPretty(),e.then("icon").required(),e.then("appKey").required(),e.field("appKey").regex(/^[a-z]+$/).then("appKey").feedback("需小写字母(作为类的包名)"),e.then("appKey").description(l=>l.appKey&&`服务端代码将创建在cn.vlife.${l.appKey}包下`),e.then("name").title("应用名称")];e.then("app","appKey","code","pcode","url","sort","pageType","pageLayoutId","formType","entityType","formId").hide(),e.then("name").title("分组名称");const I=[e.then("app","appKey","code","pcode","url","sort","pageType","pageLayoutId").hide(),e.field("id").isNotNull().then("entityType","formType").readPretty(),e.then("name").title("菜单名称"),e.field("entityType").isNotNull().then("formType").show(),e.then("entityType").required(),e.field("entityType").change().then("formType").clearValue(),e.then("icon").title("菜单图标"),e.then("url").value("/table/*"),e.then("pageType").value("crudPage")],K=[e.then("app","appKey","code","pcode","url","sort","pageType","formType","entityType","formId","pageLayoutId").hide(),e.then("name").title("菜单名称"),e.then("icon").title("菜单图标"),e.then("formId").hide().clearValue(),e.then("url").value("/chart/*"),e.then("pageType").value("chartPage")],w=[e.then("app","appKey","code","pcode","sort","formId","pageType","formType","entityType","pageLayoutId").hide(),e.then("pageType").value("customPage"),e.then("name").title("菜单名称"),e.then("icon").title("菜单图标")],C=(l,f)=>{const n=l.filter(t=>t.sysAppId===f),c=n.filter(t=>!t.pcode).sort((t,i)=>t.sort-i.sort),a=t=>{if(t.url)return t.url.endsWith("*")?t.url.substring(0,t.url.length-1)+t.id:t.url};for(const t of c){const i=a(t);if(i)return{...t,url:i};const u=n.filter(r=>r.pcode===t.code).sort((r,y)=>r.sort-y.sort).find(r=>r.url);if(u){const r=a(u);if(r)return{...u,url:r}}}},M=[{label:"表单页面",desc:"用于填写、查询数据",icon:o("i",{className:"icon-rename_input text-4xl"}),key:"crudPage"},{label:"分析页面",desc:"用于分析、可视化展现数据",icon:o("i",{className:" icon-stats_funnel_chart text-4xl"}),key:"chartPage"},{label:"二开页面",desc:"自行开发的页面功能接入",icon:o("i",{className:" icon-workflow_write text-4xl"}),key:"customPage"}],L=({onChange:l,onForm:f,pcode:n,appId:c})=>{const[a,t]=m.useState("crudPage"),{model:i}=g({type:"sysMenu"}),{model:u}=g({type:"menuCrudDto"}),[r,y]=m.useState();d.useEffect(()=>{l&&r&&l(r)},[r]);const[b,T]=d.useState(0);return d.useEffect(()=>{N({req:{appId:c,itemType:"entity"}}).then(s=>{var p;T(((p=s.data)==null?void 0:p.filter(x=>x.state!=="creating").length)||0)})},[]),d.useMemo(()=>a==="crudPage"?[...I,e.then("pcode").value(n),e.result(b===0).then("entityType").feedback("当前没有任何发布的实体")]:a==="chartPage"?[...K,e.then("pcode").value(n)]:a==="customPage"?[...w,e.then("pcode").value(n)]:[],[a,n]),h("div",{className:"w-full h-full space-x-4 flex-col",children:[o("div",{className:"w-full flex h-24 space-x-4",children:M.map((s,p)=>h("div",{onClick:()=>t(s.key),className:`${v({"border-blue-500 bg-blue-50 hover:bg-blue-50":a===s.key,"border-gray-300":a!==s.key})} relative block w-1/3 cursor-pointer  border-2 border-dashed rounded-lg  text-center hover:border-blue-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500`,children:[s.icon,o("span",{className:"mt-1 block text-sm font-bold text-gray-900",children:s.label}),o("span",{className:"mt-1 block text-sm font-medium text-gray-500",children:s.desc})]},p))}),h("div",{className:" flex flex-1  p-4",children:[i&&a==="crudPage"&&o(k,{fieldOutApiParams:{formId:{conditions:P({appId:c})}},formData:{sysAppId:c,pageType:a,pcode:n},terse:!0,formSetting:!0,onForm:f,reaction:[e.then("groupIds").value(void 0).hide()],className:"w-full",onChange:y,modelInfo:u},a),a==="chartPage"&&o("div",{className:"flex w-full  h-20 justify-center items-center text-blue-500  font-medium",children:"请升级到专业版以上"}),a==="customPage"&&o("div",{className:"flex w-full  h-20 justify-center items-center text-blue-500  font-medium",children:"开发人员通过自定义页面实现复杂功能，需要升级后使用"})]})]})};export{L as A,A as a,C as t};
