import{j as g,a as e,B as A,T as oe,P as he,E as le,I as fe,w as ye,u as G,b as V,c as Q,r as d,d as F,F as ge,e as be,s as ve,f as xe,g as Y,h as ee,i as te,S as Te,O as Ne}from"./index-MyzntyvH.js";import{N as H,L}from"./index-BglJqJ-X.js";import{l as we}from"./logo2-DYc4F8xQ.js";import{A as ie}from"./index-DjDhYITW.js";import{D as U,I as Ie}from"./index-DMtIuQia.js";import{B as q,I as Se,a as Ce,S as Pe,b as se,c as ke,d as re,u as ce,e as Ee,N as de}from"./index-CCDUBNXJ.js";import{V as l,B as Z,u as O,l as Me,F as ue,s as $e}from"./formPage-CmcGKePW.js";import{l as Ae,e as ze,r as De,c as Fe}from"./SysApp-RrgTyjfo.js";import{s as W,a as ne,r as Ke}from"./SysMenu-BFELX6vf.js";import{G as Re}from"./GroupButton-m5Wg7-MC.js";import{m as j}from"./static-wPmgQVRS.js";import{v as Ue}from"./vlifeModal-BAjBxvKE.js";import"./toInteger-Ck1rw1Xb.js";import"./index-RrMxwDnz.js";const Le=({className:i})=>g("div",{className:`${i} flex`,children:[e(A,{theme:"borderless",icon:e("i",{className:" icon-qq text-xl text-blue-500 "}),style:{color:"var(--semi-color-text-2)",marginRight:"12px"},onClick:()=>{var t="https://qm.qq.com/cgi-bin/qm/qr?_wv=1027&k=zznRalE15vpDdHf5BWsBzVo_5A73mC_C&authKey=W5yiKOuVWgPY5UVAIhbiX1nvO62%2Fewf4vnrpi2shCZI7VgOqEsqsfKb7y6xI8qUi&noverify=0&group_code=786134846";window.open(t)},children:e(oe,{content:"点击加群786134846",children:" 点击进QQ群"})}),e(he,{content:e(le,{image:e(fe,{src:ye}),title:"微信vlifeboot",description:"技术支持/商务合作",style:{width:200,margin:"0 auto",display:"flex",padding:5}}),children:e(A,{theme:"borderless",icon:e("i",{className:"iconfont icon-weixin text-xl text-green-500 "}),style:{color:"var(--semi-color-text-2)",marginRight:"12px"},children:"添加微信"})})]}),qe=[l.then("app").value(!0).hide(),l.then("url","formId","pcode","pageType","pageLayoutId","formType","entityType").hide().clearValue(),l.field("id").isNotNull().then("appKey").readPretty(),l.then("icon").required(),l.then("appKey").required(),l.field("appKey").regex(/^[a-z]+$/).then("appKey").feedback("需小写字母(作为类的包名)"),l.then("appKey").description(i=>i.appKey&&`服务端代码将创建在cn.vlife.${i.appKey}包下`),l.then("name").title("应用名称")];l.then("app","appKey","code","pcode","url","sort","pageType","pageLayoutId","formType","entityType","formId").hide(),l.then("name").title("分组名称");const Oe=[l.then("app","appKey","code","pcode","url","sort","pageType","pageLayoutId").hide(),l.field("id").isNotNull().then("entityType","formType").readPretty(),l.then("name").title("菜单名称"),l.field("entityType").isNotNull().then("formType").show(),l.then("entityType").required(),l.field("entityType").change().then("formType").clearValue(),l.then("icon").title("菜单图标"),l.then("url").value("/table/*"),l.then("pageType").value("crudPage")],Be=[l.then("app","appKey","code","pcode","url","sort","pageType","formType","entityType","formId","pageLayoutId").hide(),l.then("name").title("菜单名称"),l.then("icon").title("菜单图标"),l.then("formId").hide().clearValue(),l.then("url").value("/chart/*"),l.then("pageType").value("chartPage")],_e=[l.then("app","appKey","code","pcode","sort","formId","pageType","formType","entityType","pageLayoutId").hide(),l.then("pageType").value("customPage"),l.then("name").title("菜单名称"),l.then("icon").title("菜单图标")],We=(i,t)=>{const h=i.filter(r=>r.sysAppId===t),c=h.filter(r=>!r.pcode).sort((r,T)=>r.sort-T.sort),u=r=>{if(r.url)return r.url.endsWith("*")?r.url.substring(0,r.url.length-1)+r.id:r.url};for(const r of c){const T=u(r);if(T)return{...r,url:T};const S=h.filter(m=>m.pcode===r.code).sort((m,$)=>m.sort-$.sort).find(m=>m.url);if(S){const m=u(S);if(m)return{...S,url:m}}}},je={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_API_URL:"http://localhost:8288",VITE_APP_MODE:"pro",VITE_APP_PAGESIZE:"15",VITE_APP_SAVE_REMOVE:"true",VITE_APP_TITLE:"vlife快速研发平台",VITE_APP_VERSION:"v_base"},He="http://localhost:8288",{Header:Ge}=L,{VITE_APP_API_URL:Ve}=je;function pe(i){return i?typeof i=="string"?e("div",{className:"h-full flex items-center",children:e(Pe,{readPretty:!0,value:i})}):i.render():null}const Qe=()=>{const{loginOut:i,user:t,setApp:h,app:c,menu:u,setMenu:r,datasInit:T,sysVar:S}=G(),m=V(),$=Q(),{pathname:p}=$,[f,C]=d.useState(),k=d.useCallback(()=>{Ae().then(b=>{var E;const a=[...new Set(t==null?void 0:t.menus.map(N=>N.sysAppId))],v=(E=b.data)==null?void 0:E.filter(N=>(t==null?void 0:t.superUser)||a.includes(N.id)).sort((N,z)=>N.sort-z.sort);C(v)})},[t==null?void 0:t.menus.map(b=>b.sysAppId).join("")]);d.useEffect(()=>{k()},[t==null?void 0:t.menus.map(b=>b.sysAppId).join("")]),d.useEffect(()=>{var b,a;if(!u&&!c&&f&&f.length>0){if(p==="/"||p==="")h(f[0]);else if(p){let v=(a=(b=t==null?void 0:t.menus)==null?void 0:b.filter(E=>E.url===p||p.endsWith(E.id)))==null?void 0:a[0];v!==void 0?(h(f==null?void 0:f.find(E=>E.id===(v==null?void 0:v.sysAppId))),r(v)):h(f[0])}}},[p,f]);const P=d.useMemo(()=>(f==null?void 0:f.map(a=>({itemKey:a.id,icon:pe(a.icon),onClick:()=>{a.id!==(c==null?void 0:c.id)&&h(a)},text:g("div",{className:`${F({" text-blue-500 ":(c==null?void 0:c.id)===a.id})} z-10 flex !items-center relative  hover:text-blue-500 `,children:[e("span",{children:a.name}),(t==null?void 0:t.superUser)&&e("div",{className:"!z-20",onClick:v=>{v.cancelable=!0,v.stopPropagation()},children:e(Z,{dropdown:!0,onDataChange:()=>{T("menu")},btns:[{title:"编辑应用",saveApi:ze,model:"sysApp",actionType:"edit",reaction:qe,submitClose:!0,datas:a,onSubmitFinish:()=>{k()}},{title:"删除应用",saveApi:De,actionType:"api",multiple:!0,datas:a,usableMatch:v=>(t==null?void 0:t.menus.filter(E=>{var N;return E.sysAppId===((N=v==null?void 0:v[0])==null?void 0:N.id)}).length)>0?"应用下有模块不能删除":!0,onSubmitFinish:()=>{k()}}]},`app_${a.id}`)})]},`app_${a.id}`)})))||[],[f,p,c]);return e(Ge,{className:"layout-header shadow",children:e(H,{mode:"horizontal",header:e("div",{className:" flex !items-center cursor-pointer ",onClick:()=>{m("/dashboard")},style:{width:160,height:30,top:10},children:S!=null&&S.icon?e("img",{src:He+"/sysFile/image/"+S.icon,style:{width:160,height:40,top:10}}):e(le,{className:" relative top-3  mr-4",image:e("img",{src:we,style:{width:160,height:40,top:10}})})}),selectedKeys:[(c==null?void 0:c.id)||""],items:P,footer:g(ge,{children:[(t==null?void 0:t.superUser)&&g("div",{className:"flex",children:[e(q,{theme:"solid",className:" h-full items-center   ",title:"创建应用",icon:e("i",{className:"  icon-task_add-02"}),actionType:"create",model:"sysApp",allowEmpty:!0,submitClose:!0,saveApi:Fe,reaction:[l.then("appKey").description(b=>b.appKey&&`服务端代码将创建在cn.vlife.${b.appKey}包下`),l.then("sort").value(((f==null?void 0:f.length)||0)+1)],onSubmitFinish:(...b)=>{h(b[0]),C(a=>[...a||[],b[0]]),T("menu")}},`createApp_${p}`),e(A,{theme:"borderless",onClick:()=>{m(`/design/modelDesign${c&&`?appId=${c.id}`}`)},style:{color:"var(--semi-color-text-2)"},icon:e("i",{className:"icon-settings text-xl text-indigo-500"}),children:"模型管理"}),e(A,{theme:"borderless",style:{color:"var(--semi-color-text-2)"},onClick:()=>{m("/vlife/common/iconContainer")},icon:e("i",{className:"icon-descending-order2 text-xl"}),children:"图标库"}),e(Le,{}),e(A,{theme:"borderless",icon:e(Se,{size:"large"}),style:{color:"var(--semi-color-text-2)",marginRight:"12px"},onClick:()=>{window.open("http://vlife.cc")},children:"使用指南"}),e(A,{theme:"borderless",icon:e(Ce,{size:"large"}),style:{color:"var(--semi-color-text-2)",marginRight:"12px"},onClick:()=>{window.open("https://gitee.com/wwwlike/vlife")},children:"GITEE"})]}),e("div",{className:" m-2 !text-sm !text-blue-300 font-medium cursor-pointer",onClick:()=>{window.open("http://vlife.cc")},children:"vlife基础版"}),e(U,{position:"bottomLeft",render:g(U.Menu,{children:[g(U.Item,{onClick:i,children:[e("i",{className:"  icon-exit_to_app mr-2"}),e("span",{children:"退出登录"})]}),g(U.Item,{children:[e("i",{className:"  icon-limit-othermember mr-2"}),e(q,{btnType:"link",loadApi:be,model:"sysUserDto",actionType:"edit",reaction:[l.then("name","username","sysDeptId","sysUserGroup_sysGroupId").readPretty(),l.then("superUser","state").hide()],datas:{id:t==null?void 0:t.id},allowEmpty:!0,saveApi:ve,title:"基本信息"})]}),g(U.Item,{children:[e("i",{className:"  icon-password mr-2"}),e(q,{btnType:"link",datas:{id:t==null?void 0:t.id},model:"userPasswordModifyDto",actionType:"edit",submitClose:!0,saveApi:xe,onSubmitFinish:b=>{i()},title:"密码修改"})]})]}),children:t!=null&&t.avatar?e(ie,{alt:"beautiful cat",size:"small",src:`${Ve}/sysFile/image/${t==null?void 0:t.avatar}`,style:{margin:4}}):e(ie,{color:"orange",size:"small",children:t==null?void 0:t.name[0]})})]})})})},Ze=[{label:"表单页面",desc:"用于填写、查询数据",icon:e("i",{className:"icon-rename_input text-4xl"}),key:"crudPage"},{label:"分析页面",desc:"用于分析、可视化展现数据",icon:e("i",{className:" icon-stats_funnel_chart text-4xl"}),key:"chartPage"},{label:"二开页面",desc:"自行开发的页面功能接入",icon:e("i",{className:" icon-workflow_write text-4xl"}),key:"customPage"}],ae=({onChange:i,onForm:t,pcode:h,appId:c})=>{const[u,r]=Y.useState("crudPage"),{model:T}=O({type:"sysMenu"}),{model:S}=O({type:"menuCrudDto"}),[m,$]=Y.useState();d.useEffect(()=>{i&&m&&i(m)},[m]);const[p,f]=d.useState(0);return d.useEffect(()=>{Me({req:{appId:c,itemType:"entity"}}).then(C=>{var k;f(((k=C.data)==null?void 0:k.filter(P=>P.state!=="creating").length)||0)})},[]),d.useMemo(()=>u==="crudPage"?[...Oe,l.then("pcode").value(h),l.result(p===0).then("entityType").feedback("当前没有任何发布的实体")]:u==="chartPage"?[...Be,l.then("pcode").value(h)]:u==="customPage"?[..._e,l.then("pcode").value(h)]:[],[u,h]),g("div",{className:"w-full h-full space-x-4 flex-col",children:[e("div",{className:"w-full flex h-24 space-x-4",children:Ze.map((C,k)=>g("div",{onClick:()=>r(C.key),className:`${F({"border-blue-500 bg-blue-50 hover:bg-blue-50":u===C.key,"border-gray-300":u!==C.key})} relative block w-1/3 cursor-pointer  border-2 border-dashed rounded-lg  text-center hover:border-blue-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500`,children:[C.icon,e("span",{className:"mt-1 block text-sm font-bold text-gray-900",children:C.label}),e("span",{className:"mt-1 block text-sm font-medium text-gray-500",children:C.desc})]},k))}),g("div",{className:" flex flex-1  p-4",children:[T&&u==="crudPage"&&e(ue,{fieldOutApiParams:{formId:{conditions:ee({appId:c})},entityType:{conditions:ee({appId:c})}},formData:{sysAppId:c,pageType:u,pcode:h},terse:!0,formSetting:!0,onForm:t,reaction:[],className:"w-full",onChange:$,modelInfo:S},u),u==="chartPage"&&e("div",{className:"flex w-full justify-center items-center h-20 text-blue-500 font-medium",children:"可通过零代码配置不写代码和sql的方式实现看板，统计分析功能，需要升级后使用"}),u==="customPage"&&e("div",{className:"flex w-full  h-20 justify-center items-center text-blue-500  font-medium",children:"开发人员通过自定义页面实现复杂功能，需要升级后使用"})]})]})},{Sider:Je}=L,Xe=()=>{var z,K,M;const{user:i,app:t,setMenu:h,menu:c,datasInit:u}=G(),r=V(),{getModel:T}=O(),{pathname:S}=Q(),[m,$]=d.useState([]),[p,f]=d.useState([]),[C,k]=d.useState(window.innerHeight),[P,b]=d.useState({}),a=d.useMemo(()=>{var s,w;return i!=null&&i.menus&&t?(w=(s=i.menus)==null?void 0:s.slice(0,j))==null?void 0:w.filter(y=>{var n;return(n=y==null?void 0:y.sysAppId)==null?void 0:n.startsWith(t.id)}):[]},[i==null?void 0:i.menus,t]);d.useEffect(()=>{a.filter(s=>s.pageType==="crudPage").forEach(s=>{T({id:s.formId}).then(w=>{b(y=>({...y,[s.formId]:w==null?void 0:w.state}))})})},[a]),d.useEffect(()=>{if(!c&&a&&t){const s=We(a,t.id);s&&(h(s),r(s==null?void 0:s.url))}},[c,a,t]);const v=d.useCallback(s=>{var w;if(s.selectedItems&&((w=s.selectedItems[0])!=null&&w.path)){const y=s.selectedItems[0].id,n=i==null?void 0:i.menus.find(o=>o.id===y);h(n),f([y]),r(s.selectedItems[0].path)}},[i==null?void 0:i.menus]),E=s=>{$([...s.openKeys])};d.useEffect(()=>{var s,w;c&&(!p||p.length===0||!p.includes(c.id))&&(f([c==null?void 0:c.id]),(w=(s=i==null?void 0:i.menus)==null?void 0:s.filter(y=>y.code===c.pcode).map(y=>y.id))==null||w[0]),$(a.filter(y=>!y.url).map(y=>y.id))},[c,p,i==null?void 0:i.menus,a,t==null?void 0:t.id]);const N=d.useMemo(()=>{const s=(w,y)=>a.sort((n,o)=>n.sort-o.sort).filter(n=>n.pcode===(y?null:w==null?void 0:w.code)).map(n=>({id:n.id,itemKey:n.id,isLocked:!!n.pageType,text:i!=null&&i.superUser?g("div",{className:" group z-10 flex items-center relative w-28",children:[g("div",{className:"z-10 flex  w-full  items-center ",children:[g("div",{className:"flex items-center ",children:[" ",n.name]}),n.pageType==="crudPage"&&P[n.formId]!=="published"&&e(oe,{content:"可以访问，正常使用需重启服务",children:e("i",{className:" icon-replay flex items-center absolute right-6  text-red-500"})})]}),g("div",{className:"flex absolute items-center right-0 !z-20 ",onClick:o=>{o.cancelable=!0,o.stopPropagation()},children:[e(Z,{dropdown:!0,datas:[n],className:F({"hidden group-hover:block":!p.includes(n.id)}),btns:[{title:"编辑菜单",icon:e(se,{size:"small",className:"z-20"}),actionType:"edit",disabledHide:!0,disabled:n.pageType!=="crudPage",model:"menuCrudDto",saveApi:W,onSubmitFinish:(...o)=>{u("menu")}},{title:"模型设计",icon:e("i",{className:"  icon-shareLink"}),actionType:"click",disabledHide:!0,disabled:n.pageType!=="crudPage",onClick:()=>{r(`/design/modelDesign?appId=${t==null?void 0:t.id}&modelId=${n.formId}`)}},{title:"表单设计",icon:e("i",{className:"  icon-construction"}),actionType:"click",disabledHide:!0,disabled:n.pageType!=="crudPage",onClick:()=>{r(`/full/formDesign/${n.formId}`)}},{title:"编辑分组",icon:e(se,{size:"small",className:"z-20"}),actionType:"edit",disabledHide:!0,disabled:!(!n.pcode&&!n.url),model:"menuGroupDto",saveApi:ne,onSubmitFinish:(...o)=>{u("menu")}},{title:n.url?"删除菜单":"删除分组",actionType:"api",icon:e(ke,{size:"small",className:"z-20"}),saveApi:(...o)=>Ke([n.id]),submitConfirm:!0,onSubmitFinish:(...o)=>{u("menu").then(()=>{})},usableMatch:()=>{var o;return n.sys===!0?"系统级菜单不允许删除":((o=i.menus)==null?void 0:o.filter(B=>B.pcode===n.code).length)>0?"分组下有菜单不能删除":!0}}]},n.id+JSON.stringify(p)),!n.pcode&&!n.url&&e(q,{title:"添加子菜单",btnType:"icon",icon:e("i",{className:"  icon-task_add-02"}),actionType:"modal",modal:e(ae,{pcode:n.code,appId:y==null?void 0:y.id}),saveApi:W,submitClose:!0,onSubmitFinish:o=>{u("btn"),u("menu").then(()=>{f([o.data.id]),o.data.pageType==="crudPage"?r(`/table/${o.data.id}`):o.data.pageType==="chartPage"?r(`/chart/${o.data.id}`):r(`${o.data.url}`)})}},n.id+S)]})]},n.id):e("div",{onClick:()=>{h(n)},children:n.name},n.id),code:n.code,icon:n.icon?pe(n.icon):null,path:n.url&&n.url.endsWith("*")?n.url.substring(0,n.url.length-1)+n.id:n.url,items:s(n,null)}));return t&&a?s(null,t):[]},[a,t,p,i==null?void 0:i.menus,S,P]);return d.useEffect(()=>{const s=()=>{k(window.innerHeight)};return window.addEventListener("resize",s),()=>{window.removeEventListener("resize",s)}},[]),e(Je,{className:"  ",children:g(H,{toggleIconPosition:i!=null&&i.superUser?"left":"right",bodyStyle:{height:`${C-110}px`},className:"!overflow-y-auto relative  !z-10  ",items:N&&N.length>0?N:[],openKeys:m&&m.length>0?m:[(z=N==null?void 0:N[0])==null?void 0:z.id],selectedKeys:p,onSelect:v,onOpenChange:E,style:{maxWidth:220,height:"100%"},onCollapseChange:s=>{},children:[(t==null?void 0:t.id)&&(i==null?void 0:i.superUser)&&g("div",{className:` flex group items-center  ${F({"absolute top-1/3 ":a.length===0,"absolute bottom-16":a.length!=0})}  w-full  justify-center`,children:[e(Re,{className:`${F({"flex flex-col space-y-2 items-center justify-center":a.length===0," grid-cols-2 grid gap-y-2":a.length!=0})}
                  `,btns:[{icon:e("i",{className:"icon-add_circle"}),title:"建表",theme:"solid",actionType:"create",model:"form",submitClose:!0,reaction:[l.then("sysAppId").value(t.id).readPretty(),l.then("itemType").value("entity")],onSaveBefore:s=>(s.type=te(s.type),s.entityType=te(s.type),s),disabledHide:!0,saveApi:$e,onSubmitFinish:s=>{r(`/design/modelDesign?appId=${t.id}&modelId=${s.id}`)}},{title:"菜单",icon:e("i",{className:"  icon-task_add-02"}),actionType:"modal",modal:e(ae,{appId:t.id}),disabled:((K=i==null?void 0:i.menus)==null?void 0:K.filter(s=>!!s.url).length)>j,disabledTooltip:"已到达菜单数量上限,升级到标准版以上无限制",saveApi:W,submitClose:!0,onSubmitFinish:s=>{u("btn").then(()=>{u("menu").then(()=>{f([s.data.id]),s.data.pageType==="crudPage"?r(`/table/${s.data.id}`):s.data.pageType==="chartPage"?r(`/chart/${s.data.id}`):r(`${s.data.url}`)})})}},{icon:e("i",{className:"icon-add_circle"}),title:"分组",model:"menuGroupDto",saveApi:ne,actionType:"create",initData:{sysAppId:t.id},submitClose:!0,onSubmitFinish:()=>{u("menu")}},{title:"排序",disabledHide:!0,disabled:a.length<=1,allowEmpty:!0,icon:e("i",{className:" text-blue-500 icon-task-folder-slide-sort text-sm"}),actionType:"click",onClick:()=>{r("/vlife/sysMenu")}}]}),g("div",{className:" absolute -top-8 text-xs group-hover:block hidden text-red-400",children:["还可创",j-((M=i==null?void 0:i.menus)==null?void 0:M.filter(s=>!!s.url).length),"个菜单，升级后无限制"]})]},t==null?void 0:t.id),e(H.Footer,{collapseButton:!0,className:" !absolute !bottom-0  items-center justify-between  flex  w-full"})]})})},Ye=re("formModal",({modelInfo:i,formData:t,width:h,activeKey:c,onError:u,formDesign:r=!1,btns:T,modifyData:S,...m})=>{var X;const $=ce("formModal"),[p,f]=d.useState({width:window.screen.width,height:window.screen.height}),C=V(),{user:k}=G(),[P,b]=d.useState((X=T==null?void 0:T[0])==null?void 0:X.continueCreate),[a,v]=d.useState(t),[E,N]=d.useState(0),[z,K]=d.useState();d.useEffect(()=>{K(S)},[S]);const[M,s]=d.useState(),[w,y]=d.useState([]),{model:n}=O(i?{}:{type:m.type}),o=i||n,B=d.useMemo(()=>{var R;const x=(a==null?void 0:a.no)||"";if(m.title)return m.title;if(o===void 0)return`“${m.type}”模型标识不存在`;const I=(o==null?void 0:o.title)||o.type;return m.readPretty?I+"详情"+x:(R=M==null?void 0:M.values)!=null&&R.id?I+x:"新建("+I+")"},[a,M,o]),D=d.useMemo(()=>T&&M?T.map(x=>({...x,btnType:"button",position:"formFooter",datas:{...a},onSubmitFinish:I=>{P===!0||P===void 0&&x.continueCreate===!0?(v(void 0),N(R=>R+1)):(v(I),K(I)),x.onSubmitFinish&&x.onSubmitFinish(I)},onFormilySubmitCheck:()=>M.submit().then(I=>!0).catch(I=>!1)})):[],[T,M,o,a,P]),_=D.filter(x=>x.actionType==="create"&&x.continueCreate!==void 0),me=d.useMemo(()=>D&&D.length>0?g("div",{className:"flex w-full justify-end relative h-full items-center  space-x-1",children:[r===!1&&(k==null?void 0:k.superUser)===!0&&g("div",{onClick:()=>{C(`/full/formDesign/${o.type}`)},className:" flex flex-1 hover:text-blue-500  font-normal space-x-2  items-center justify-start cursor-pointer",children:[e(Ie,{size:"small"}),e("span",{children:"表单配置"})]}),_.length>0&&g("div",{className:"absolute flex left-2 items-center",children:[e("span",{className:`text-gray-400 ${F({"!text-gray-800":P!==void 0?P:_[0].continueCreate})}`,children:"连续新增"}),e(Ee,{checked:P!==void 0?P:_[0].continueCreate,onChange:x=>{b(x)},checkedText:"开",uncheckedText:"关"})]}),D.length>0?e(Z,{datas:[(a==null?void 0:a.flow)!==void 0?a:{...a}],btns:D.map(x=>({...x,modalOpen:!0})),entity:i==null?void 0:i.entityType,activeKey:c,dataType:i==null?void 0:i.type,position:"formFooter",btnType:"button"}):e(A,{onClick:()=>{$.hide()},children:"关闭"})]}):e("div",{}),[D,a,M,P]),J=d.useMemo(()=>{if(h)return h;let I=0;return(o==null?void 0:o.modelSize)===4&&(I=p.width*.65),(o==null?void 0:o.modelSize)===3&&(I=p.width*.45),(o==null?void 0:o.modelSize)===2&&(I=p.width*.35),(o==null?void 0:o.modelSize)===1&&(I=p.width*.2),I<100?100:I},[h,p.width,o]);return e(de,{id:"formModal",height:p.height/5*3,footer:me,title:B,className:"!min-h-[500px]",width:p.width>J?J:p.width,children:e(ue,{formSetting:!0,onError:y,formData:a,modelInfo:o,modifyData:z,onChange:(x,I)=>{v(R=>({...x}))},onForm:x=>{s(x)},...m},`${E}${o==null?void 0:o.id}`)})}),et=re("confirmModal",({saveFun:i,title:t="确认删除选中的记录么?"})=>{const h=ce("confirmModal"),c=d.useCallback(()=>{if(i){const u=i();if(u instanceof Promise)return u.then(r=>h.resolve(r)).finally(()=>{h.hide()});setTimeout(()=>h.resolve(u),500)}},[i]);return e(de,{id:"confirmModal",title:"操作确认",width:350,onOk:c,children:e("p",{children:t})})}),{Content:tt}=L,yt=()=>{const{pathname:i}=Q(),t=i.includes("/full/");return g(L,{className:"layout-page",children:[!t&&e(Qe,{}),g(L,{children:[!t&&e(Xe,{}),e(tt,{className:"layout-content bg-gray-50",children:e(d.Suspense,{fallback:e(Te,{message:"正在加载中"}),children:e(Ne,{})})})]}),e(Ye,{}),e(et,{}),e(Ue,{})]})};export{yt as default};
